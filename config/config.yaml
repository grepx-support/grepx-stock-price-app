# Price App Configuration

# App metadata
app:
  name: "price_app"
  version: "1.0.0"

# Celery configuration
celery:
  broker_url: "redis://127.0.0.1:6379/0"
  result_backend: "redis://127.0.0.1:6379/1"
  task_serializer: "json"
  result_serializer: "json"
  accept_content:
    - json
  timezone: "Asia/Kolkata"
  enable_utc: true
  synchronous: true

worker:
  pool: "prefork"  # ⚡ Changed from 'solo' to prefork for parallel execution
  max_concurrent: 5  # ⚡ Increased from 10
  worker_prefetch_multiplier: 4  # ⚡ Better load balancing
  worker_max_tasks_per_child: 1000


task:
  track_started: true
  time_limit: 600  # ⚡ Reduced from 1800s (was too long)
  soft_time_limit: 500
  # ⚡ NEW: Task compression to reduce network I/O
  task_compression: "gzip"
  # ⚡ NEW: Ignore results if not needed
  task_ignore_result: false
  # ⚡ NEW: Reduce retry attempts
  autoretry_for: [Exception]
  max_retries: 2
  default_retry_delay: 5

tasks:
  modules:
    - "tasks.base_tasks"
    - "tasks.stocks.stocks_tasks"
    - "tasks.indices.indices_tasks"
    - "tasks.futures.futures_tasks"

  directories: []

# Database configuration (ORM)
database:
  #connection_string: "mongodb+srv://grepx_mongo_user:Singapore%40123@grepx.f0vzhpn.mongodb.net/stock_analysis_demo?appName=grepx"
  connection_string: "mongodb://admin:password123@localhost:27017/stock_analysis?authSource=admin"
  # connection_string: "mongodb://localhost:27017/mydb"
  # Alternative formats:
  #connection_string: "sqlite:///example.db"
  # PostgreSQL: "postgresql://user:pass@localhost:5432/stock_analysis"
  # MongoDB Local: "mongodb://admin:password123@localhost:27017/stock_analysis"

asset_types:
  stocks:
    symbols:
      - "AAPL"
      - "GOOGL"
      - "MSFT"
      - "TSLA"
      - "AMZN"
    fetch_timeout: 120
    store_timeout: 120
    
  indices:
    symbols:
      - "^GSPC"
      - "^NSEI"
    fetch_timeout: 120
    store_timeout: 120
    
  futures:
    symbols:
      - "ES=F"
      - "NQ=F"
      - "YM=F"
    fetch_timeout: 180
    store_timeout: 180

start_date: "2021-12-01"
end_date: "2025-12-01"

indicators:
  SMA:
    periods: [10, 20, 50, 100, 200]
  EMA:
    periods: [12, 26, 50]
  RSI:
    period: 14
  MACD:
    fast: 12
    slow: 26
    signal: 9
  BOLLINGER:
    period: 20
    std_dev: 2
  ATR:
    period: 14

factors:
  missing_value:
    text: "no data available"
    numeric: null

columns:
  high: "high"
  low: "low"
  close: "close"
  open: "open"
  volume: "volume"

naming_convention:
  case_mode: lower
  separator: "_"
  price_template: "{symbol}{sep}prices"
  indicator_template: "{symbol}{sep}{factor}"